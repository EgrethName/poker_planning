(function(t){function e(e){for(var s,i,r=e[0],c=e[1],l=e[2],d=0,f=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],s=!0,r=1;r<o.length;r++){var c=o[r];0!==n[c]&&(s=!1)}s&&(a.splice(e--,1),t=i(i.s=o[0]))}return t}var s={},n={1:0},a=[];function i(e){if(s[e])return s[e].exports;var o=s[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=s,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(o,s,function(e){return t[e]}.bind(null,s));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([0,0]),o()})({0:function(t,e,o){t.exports=o("cb6a")},"0418":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container header-intro"},[o("div",{staticClass:"row"},[t._m(0),o("div",{staticClass:"col-lg-4 col-sm-2"}),o("div",{staticClass:"col-lg-4 col-sm-6"},[o("div",{staticClass:"btn-wrapper",attrs:{id:"disabled-wrapper",tabindex:"0"}},[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-login",modifiers:{"modal-login":!0}}],staticClass:"btn-intro",attrs:{disabled:""}},[t._v(" Log In ")])],1),o("div",{staticClass:"btn-wrapper",attrs:{id:"disabled-wrapper-2"}},[o("b-button",{staticClass:"btn-intro",attrs:{disabled:""}},[t._v(" Sign Up ")])],1),o("div",{staticClass:"btn-wrapper"},[o("b-button",{staticClass:"btn-intro",on:{click:t.logout}},[t._v(" Log out ")])],1),o("b-tooltip",{attrs:{target:"disabled-wrapper"}},[t._v(t._s(t.tooltipText))]),o("b-tooltip",{attrs:{target:"disabled-wrapper-2"}},[t._v(t._s(t.tooltipText))])],1),o("LoginModal",{attrs:{msg:"Log In"}})],1)])},n=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col-lg-4 col-sm-4"},[o("p",{staticClass:"text-general"},[t._v("Poker Planning")])])}],a=o("479f"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-modal",{ref:"modal",attrs:{id:"modal-login",title:t.msg,"ok-title":"Submit","cancel-variant":"dark",centered:"","no-close-on-esc":"","no-close-on-backdrop":""},on:{show:t.resetModal,hidden:t.resetModal,ok:t.handleOk}},[o("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[o("b-form-group",{attrs:{label:"Login","label-for":"login-input","invalid-feedback":"Login is required",state:t.loginState}},[o("b-form-input",{attrs:{id:"login-input",state:t.loginState,required:""},model:{value:t.login,callback:function(e){t.login=e},expression:"login"}})],1),o("b-form-group",{attrs:{label:"Password","label-for":"password-input","invalid-feedback":"Password is required",state:t.passwordState}},[o("b-form-input",{attrs:{id:"password-input",state:t.passwordState,type:"password",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1)])],1)},r=[],c={data:function(){return{login:"",password:"",show:!0,loginState:null,passwordState:null}},props:{msg:String},methods:{checkFormValidity:function(){return this.loginState=!0,this.passwordState=!0,this.login||(this.loginState=!1),this.password||(this.passwordState=!1),this.loginState&&this.passwordState},resetModal:function(){this.login="",this.loginState=null,this.password="",this.passwordState=null},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){var t=this;this.checkFormValidity()&&this.$nextTick((function(){t.$bvModal.hide("modal-login")}))}}},l=c,u=(o("d2d6"),o("2877")),d=Object(u["a"])(l,i,r,!1,null,null,null),f=d.exports,p={components:{LoginModal:f},props:{tooltipText:String},methods:{logout:function(){localStorage.removeItem("name"),window.location.assign("".concat(a["b"]))}}},m=p,h=(o("505a"),Object(u["a"])(m,s,n,!1,null,"dc54a27a",null));e["a"]=h.exports},1:function(t,e){},1134:function(t,e,o){"use strict";o("6bae")},4158:function(t,e,o){"use strict";o("4306")},4306:function(t,e,o){},"479f":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return l}));o("1276"),o("ac1f");var s=o("bc3a"),n=o.n(s),a=o("806a"),i="https://".concat(a["a"]),r=n.a.create({baseURL:i}),c=window.location.href.split("/"),l=c[c.length-1]},"4fc8":function(t,e,o){},"505a":function(t,e,o){"use strict";o("b011")},"550b":function(t,e,o){"use strict";o("8b52")},"6bae":function(t,e,o){},"6e8e":function(t,e,o){"use strict";o("b1bf")},"7c7a":function(t,e,o){"use strict";o("9883")},"806a":function(t,e,o){"use strict";var s=function(t){switch(t){case"development":return"192.168.2.15";case"production":return window.location.host;case"test":default:return"localhost:8001"}};e["a"]=s(Object({NODE_ENV:"production",VUE_APP_IP:"192.168.2.15",BASE_URL:"/"}).VUE_APP_TEST_MODE||"production")},"8b52":function(t,e,o){},9883:function(t,e,o){},a2f0:function(t,e,o){},af41:function(t,e,o){},b011:function(t,e,o){},b1bf:function(t,e,o){},b9fd:function(t,e,o){"use strict";o("4fc8")},cb6a:function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d"),o("a2f0");var s=o("2b0e"),n=o("5f5b"),a=o("b1e0"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("Header",{attrs:{tooltipText:"Coming soon..."}}),o("div",{staticClass:"wrapper container"},[o("Game")],1)],1)},r=[],c=o("0418"),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"game-container container",attrs:{id:"game-box"}},[o("div",{staticClass:"row game-header"},[o("h2",[t._v(t._s(t.roomName))])]),o("div",{staticClass:"row game-main"},[o("div",{staticClass:"col-lg-2"}),o("div",{staticClass:"col-lg-4 card-box"},[o("div",{staticClass:"name-header"},[o("h3",[t._v(" You are logged as: "+t._s(t.playerName))])]),o("b-overlay",{attrs:{id:"overlay-background",show:!t.isVoteActive,rounded:"sm",opacity:"1"},scopedSlots:t._u([{key:"overlay",fn:function(){return[o("div",{staticClass:"text-center"},[o("b-icon",{attrs:{icon:"stopwatch","font-scale":"3",animation:"fade"}}),o("p",{attrs:{id:"cancel-label"}},[t._v("Please, start a new vote")])],1)]},proxy:!0}])},[o("div",{staticClass:"card-holder"},t._l(t.cardSet,(function(e){return o("Card",{key:e,ref:"cards",refInFor:!0,attrs:{value:e},on:{voted:t.processVote}})})),1)]),o("div",{staticClass:"invitation-link"},[o("InvitationPanel",{attrs:{link:t.gameLink}})],1)],1),o("div",{staticClass:"col-lg-6 game-table-container"},[o("GameTable",{on:{voteCompleted:t.showStatsModalFromData}})],1),o("InputNameModal",{ref:"modalComponent",on:{clicked:t.enterTheGame},model:{value:t.submitNameSuccess,callback:function(e){t.submitNameSuccess=e},expression:"submitNameSuccess"}}),o("CompletedVoteModal",{ref:"statsModal",attrs:{stats:t.currentStats}})],1),o("div",{staticClass:"row completed-votes"},[o("div",{staticClass:"col-lg-4"}),o("div",{staticClass:"col-lg-4 col-sm-12"},[o("p",[t._v("Completed votes")]),o("b-collapse",{attrs:{visible:"",id:"collapse-2"}},[o("div",{staticClass:"holder"},t._l(t.completedVotes,(function(e){return o("CompletedVoteBadge",{key:e.id,ref:"completedVotes",refInFor:!0,attrs:{stats:e},on:{clicked:t.showStatsModal}})})),1)])],1),o("div",{staticClass:"col-lg-4"})])])},u=[],d=o("b85c"),f=o("5530"),p=(o("b0c0"),o("0644")),m=o.n(p),h=new s["default"],v=h,b=o("2f62"),g=o("479f"),S=o("806a"),V=o("8055"),_=o.n(V),w=_.a.connect("https://".concat(S["a"])),y=w,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("button",{class:t.classList,on:{click:t.setVote}},[o("h3",[t._v(t._s(t.value))])])])},k=[],O={data:function(){return{basicClass:"card-item",selectedClass:"card-item__selected",isSelected:this.selected}},computed:{classList:function(){return[this.isSelected?this.selectedClass:"",this.basicClass]}},props:{value:String,selected:Boolean},methods:{setVote:function(){this.$emit("voted",this.value)}}},j=O,x=(o("e21e"),o("2877")),$=Object(x["a"])(j,C,k,!1,null,"26ceec1c",null),P=$.exports,I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"fix-height game-field"},[o("b-form-input",{staticClass:"input-name",attrs:{state:t.inputState,type:"text",placeholder:"Type current story title",disabled:t.isVoteActive,"v-on:keyup":t.flushInputState},model:{value:t.currentVoteTitle,callback:function(e){t.currentVoteTitle=e},expression:"currentVoteTitle"}}),o("b-button",{attrs:{variant:t.isVoteActive?"success":"primary",block:""},domProps:{textContent:t._s(t.isVoteActive?"End the vote":"Start a new vote")},on:{click:t.processVoteButton}}),o("div",{staticClass:"game-table"},[o("p",[t._v("Currently in the game:")]),o("div",{staticClass:"players-list"},[o("div",{staticClass:"column"},t._l(t.playersList,(function(t){return o("PlayerBadge",{key:t,ref:"players",refInFor:!0,attrs:{name:t}})})),1)])])],1)},A=[],T=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"player-badge"},[o("div",{class:[t.basicClass,t.stateClass]},[t._v(" "+t._s(t.name)+" "),t.isPending?o("b-icon",{staticClass:"icon-player",attrs:{icon:"arrow-clockwise",animation:"spin","font-scale":"1"}}):t._e()],1),t.isVotingCompleted?o("div",{staticClass:"mark-holder",domProps:{textContent:t._s(t.markValue)}}):t._e()])},N=[],M={data:function(){return{basicClass:"player"}},props:{name:String},computed:Object(f["a"])(Object(f["a"])({},Object(b["b"])({voteStatistics:function(t){return t.voteStatistics.votes},isVotingStarted:function(t){return t.isVoteActive},isVotingCompleted:function(t){return t.isVoteCompleted}})),{},{isVoted:function(){return console.log(this.name,this.voteStatistics),this.name in this.voteStatistics},mark:function(){return this.voteStatistics[this.name]},stateClass:function(){return this.isVoted?"player__voted":""},isPending:function(){return!this.isVoted&&this.isVotingStarted},markValue:function(){return this.isVoted&&!this.isVotingStarted?this.mark:"?"}})},L=M,E=(o("1134"),Object(x["a"])(L,T,N,!1,null,"324c2932",null)),D=E.exports,F={data:function(){return{inputState:null}},components:{PlayerBadge:D},computed:Object(f["a"])(Object(f["a"])({},Object(b["b"])({playersList:function(t){return t.playersList},isVoteActive:function(t){return t.isVoteActive},voteStatistics:function(t){return t.voteStatistics.votes},isVotingCompleted:function(t){return t.isVoteCompleted}})),{},{currentVoteTitle:{get:function(){return this.$store.state.activeVoteTitle},set:function(t){this.$store.commit("setActiveVoteTitle",t)}}}),methods:{processVoteButton:function(){if(this.isVoteActive)return this.endVote();this.startVote()},flushInputState:function(){this.inputState=null},cleanInputPlaceholder:function(){this.flushInputState(),this.currentVoteTitle=""},endVote:function(){this.$store.dispatch("endVote"),this.cleanInputPlaceholder()},startVote:function(){this.currentVoteTitle?(this.inputState=!0,this.$store.dispatch("startNewVote",this.currentVoteTitle)):this.inputState=!1}},created:function(){var t=this;v.$on("voteCompleted",(function(){t.cleanInputPlaceholder()}))}},B=F,G=(o("b9fd"),Object(x["a"])(B,I,A,!1,null,"3950f4ea",null)),R=G.exports,U=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-modal",{ref:"modalName",attrs:{id:"modal-input-name",title:"Type your name","ok-title":"Send","no-close-on-esc":"","no-close-on-backdrop":""},on:{show:t.resetModal,hidden:t.resetModal,ok:t.handleOk}},[o("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[o("b-form-group",{attrs:{label:"Name","label-for":"name-input","invalid-feedback":"Name is required",state:t.nameState}},[o("b-form-input",{attrs:{id:"name-input",state:t.nameState,required:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1)])],1)},q=[],H={data:function(){return{name:"",nameState:null,submitNameSuccess:!1}},props:["value"],computed:Object(f["a"])({},Object(b["b"])({playerName:function(t){return t.playerName}})),methods:{checkFormValidity:function(){return this.name},resetModal:function(){this.name="",this.nameState=null,this.submitNameSuccess=!1},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){this.checkFormValidity()&&this.$emit("clicked",this.name)},show:function(){this.$refs.modalName.show()}},watch:{value:function(t){t?this.$bvModal.hide("modal-input-name"):this.resetModal()}}},J=H,z=Object(x["a"])(J,U,q,!1,null,null,null),W=z.exports,Y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-modal",{ref:"modal",attrs:{id:"modal-center",centered:"",title:t.title,"ok-only":"",size:"md",scrollable:"","content-class":"modal-stats-content"}},[o("div",{staticClass:"average-fan"},[o("p",{staticClass:"my-4"},[t._v("Average: "+t._s(t.average))])]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-lg-6 col-sm-6 col-6 average-enjoyer border-right"},[o("h3",[t._v(" Votes: ")]),0===Object.keys(t.votes).length?o("div",[t._v("--")]):t._l(t.votes,(function(e,s){return o("div",{key:s},[t._v(t._s(s)+": "+t._s(e))])}))],2),o("div",{staticClass:"col-lg-6 col-sm-6 col-6 average-enjoyer"},[o("h3",[t._v(" Distribution: ")]),0===Object.keys(t.countedMarks).length?o("div",[t._v("--")]):t._l(t.countedMarks,(function(e,s){return o("div",{key:s},[t._v(t._s(s)+": "+t._s(e)+" "+t._s(t.voteDescr(e)))])}))],2)]),o("div",{staticClass:"chart"},[o("PieChart",{attrs:{data:t.counterMarksAsList}})],1)])],1)},K=[],Q=o("3835"),X=(o("07ac"),o("4fad"),o("d81d"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("svg",{attrs:{width:t.width,height:t.height}})}),Z=[],tt=(o("99af"),o("5698")),et={data:function(){return{width:268,height:268,arc:null}},mounted:function(){var t=tt.select(this.$el),e=+t.attr("width"),o=+t.attr("height"),s={top:20,left:0,bottom:30,right:0},n=e-(s.left+s.right),a=o-(s.top+s.bottom);this.chartLayer=t.append("g").attr("transform","translate(".concat(s.left,", ").concat(s.top,")")),this.arc=tt.arc().outerRadius(a/2).innerRadius(a/4).padAngle(.03).cornerRadius(8),this.pieG=this.chartLayer.append("g").attr("transform","translate(".concat(n/2,", ").concat(a/2,")")),this.drawChart(this.data)},props:["data"],watch:{data:function(t){this.drawChart(t)}},methods:{drawChart:function(t){var e=this.arc,o=tt.pie().sort(null).value((function(t){return t.value}))(t),s=this.pieG.selectAll(".arc").data(o);s.select("path").attr("d",this.arc);var n=s.enter().append("g").classed("arc",!0);n.append("path").attr("d",this.arc).attr("id",(function(t,e){return"arc-"+e})).attr("stroke","gray").attr("fill",(function(){return tt.interpolateCool(Math.random())})),n.append("text").attr("transform",(function(t){return"translate("+e.centroid(t)+")"})).style("text-anchor","middle").style("font-size",20).style("font-weight",600).text((function(t){return console.log(t),t.data.name}))}}},ot=et,st=Object(x["a"])(ot,X,Z,!1,null,null,null),nt=st.exports,at={components:{PieChart:nt},data:function(){return{width:200,height:200}},props:{stats:Object},computed:{title:function(){return console.log(this.stats),this.stats.title?this.stats.title:""},average:function(){return this.stats.average},votes:function(){return console.log(this.stats.votes),this.stats.votes},uniqueVotes:function(){var t=Object.values(this.stats.votes);return console.log(t),t},votesAsList:function(){var t=Object.entries(this.votes);return t.map((function(t){return{name:t[0],value:t[1]}}))},countedMarks:function(){for(var t={},e=0,o=Object.entries(this.votes);e<o.length;e++){var s=Object(Q["a"])(o[e],2),n=(s[0],s[1]);n in t?t["".concat(n)]+=1:t["".concat(n)]=1}return console.log("cnt",t),t},counterMarksAsList:function(){var t=Object.entries(this.countedMarks);return t.map((function(t){return{name:t[0],value:t[1]}}))}},methods:{show:function(){this.$refs.modal.show()},hide:function(){this.$refs.modal.hide()},voteDescr:function(t){return"1"==t?"vote":"votes"}}},it=at,rt=(o("550b"),Object(x["a"])(it,Y,K,!1,null,null,null)),ct=rt.exports,lt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("button",{staticClass:"completed-vote-badge",on:{click:t.onClick}},[t._v(" "+t._s(t.title)+" ")])])},ut=[],dt={props:{stats:Object},computed:{title:function(){return this.stats.title},id:function(){return this.stats.id}},methods:{onClick:function(){this.$emit("clicked",this.id)}}},ft=dt,pt=(o("4158"),Object(x["a"])(ft,lt,ut,!1,null,"4dd31fe3",null)),mt=pt.exports,ht=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"share-input"},[t._m(0),o("b-input-group",{scopedSlots:t._u([{key:"append",fn:function(){return[o("b-input-group-text",{staticClass:"copy-button",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.copyToClipboard(e)}}},[o("b-icon",{attrs:{icon:"clipboard"}})],1)]},proxy:!0}])},[o("b-form-input",{attrs:{id:"input-link",onClick:"this.select();",readonly:""},model:{value:t.link,callback:function(e){t.link=e},expression:"link"}})],1)],1)},vt=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"invitation"}},[o("h5",[t._v("Invite more people!")])])}],bt={props:{link:String},methods:{copyToClipboard:function(){console.log("copy");var t=document.querySelector("#input-link");t.setAttribute("type","text"),t.select(),document.execCommand("copy"),window.getSelection().removeAllRanges()}}},gt=bt,St=(o("6e8e"),Object(x["a"])(gt,ht,vt,!1,null,"884cbf68",null)),Vt=St.exports,_t={data:function(){return{name:"",players:[],flags:{isVoteDone:!1,isVoteStarted:!1},cards:null,passwordState:null,submitNameSuccess:!1,currentStats:{id:"",title:"",votes:{},average:0}}},props:{},components:{Card:P,GameTable:R,InputNameModal:W,CompletedVoteModal:ct,CompletedVoteBadge:mt,InvitationPanel:Vt},computed:Object(f["a"])({cardSet:function(){return["0","1","2","3","5","8","13","21","34","55","89","âˆž","?"]}},Object(b["b"])({playerName:function(t){return t.playerName},sessionId:function(t){return t.sessionId},roomName:function(t){return t.roomName},completedVotes:function(t){return t.completedVotes},wsSessionId:function(t){return t.wsSessionId},isVoteActive:function(t){return t.isVoteActive},lastVoteResults:function(t){return t.voteStatistics},gameLink:function(t){return t.gameLink}})),methods:{enterTheGame:function(t){var e=this;g["c"].post("/".concat(this.sessionId,"/join_game"),{user_name:t,ws_sid:this.wsSessionId}).then((function(){e.submitNameSuccess=!0,localStorage.name=t,e.$store.commit("setPlayerName",t),e.$store.dispatch("getAllPlayers")})).catch((function(){e.showAlert(),e.submitNameSuccess=!1}))},processVote:function(t){this.$store.dispatch("sendVote",t);var e,o=Object(d["a"])(this.$refs.cards);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.value===t?s.isSelected=!0:s.isSelected=!1}}catch(n){o.e(n)}finally{o.f()}},clearCardVotes:function(){var t,e=Object(d["a"])(this.$refs.cards);try{for(e.s();!(t=e.n()).done;){var o=t.value;o.isSelected=!1}}catch(s){e.e(s)}finally{e.f()}},showStatsModalFromData:function(t){console.log("last res",t),this.currentStats=m()(t),this.$refs.statsModal.show()},showStatsModal:function(t){var e,o={},s=Object(d["a"])(this.completedVotes);try{for(s.s();!(e=s.n()).done;){var n=e.value;if(n.id===t){o=m()(n);break}}}catch(a){s.e(a)}finally{s.f()}this.currentStats=o,this.$refs.statsModal.show()},hideStatsModal:function(){this.$refs.statsModal.hide()},scrollToEnd:function(){var t=document.getElementById("game-box");console.log(t.scrollTop,t.scrollHeight),t.scrollTop=t.scrollHeight-t.clientHeight,console.log(t.scrollTop,t.scrollHeight)}},mounted:function(){var t=this;console.log(this.completedVotes),y.on("connect",(function(){console.log("connected"),t.$store.commit("setWSSessionId",y.id),console.log(t.wsSessionId),localStorage.name?(t.$store.commit("setPlayerName",localStorage.name),t.enterTheGame(localStorage.name)):t.$refs.modalComponent.show()})),this.$root.$on("shown",(function(e,o){console.log("collapseId:",e),console.log("isJustShown:",o),o&&t.scrollToEnd()}))},watch:{isVoteActive:function(t){t||this.clearCardVotes()},completedVotes:{deep:!0,handler:function(t){console.log("The list of completed votes has changed!",t)}}},created:function(){var t=this;console.log("created"),this.$store.dispatch("activate"),this.$store.dispatch("getSessionInfo"),v.$on("voteStatsAvailable",(function(e){t.showStatsModalFromData(e)})),v.$on("newVoteStarted",(function(){t.hideStatsModal()}))}},wt=_t,yt=(o("ef66"),Object(x["a"])(wt,l,u,!1,null,"9de94b5c",null)),Ct=yt.exports,kt={name:"",components:{Header:c["a"],Game:Ct}},Ot=kt,jt=(o("7c7a"),Object(x["a"])(Ot,i,r,!1,null,null,null)),xt=jt.exports;o("4de4"),o("d3b7");s["default"].use(b["a"]);var $t=new b["a"].Store({state:{playersList:["Player1","Player2","Player3"],playerName:"",isVoteActive:!1,isVoteCompleted:!1,voteStatistics:{id:"",title:"",average:0,votes:{}},isVoteSet:!1,sessionId:g["a"],wsSessionId:y.id,completedVotes:[],roomName:"",activeVoteTitle:"",gameLink:window.location.href},mutations:{setSessionId:function(t,e){t.sessionId=e},setPlayersList:function(t,e){t.playersList=e},addNewUser:function(t,e){console.log(t.playersList.indexOf(e),e,t.playersList),-1===t.playersList.indexOf(e)&&t.playersList.push(e)},removeUser:function(t,e){console.log(t.playersList.indexOf(e),e,t.playersList),t.playersList=t.playersList.filter((function(t){return t!==e}))},setVotes:function(t,e){t.voteStatistics.votes=Object.assign({},t.voteStatistics.votes,e)},clearVoteStats:function(t){t.voteStatistics.votes={}},setVoteActive:function(t,e){t.isVoteActive=e},setVoteCompleted:function(t,e){t.isVoteCompleted=e},setInitialCompletedVotes:function(t,e){t.completedVotes=m()(e)},setVoteStats:function(t,e){console.log("setting vote stats",e),t.completedVotes.push(e)},setVoteSet:function(t,e){t.isVoteSet=e},setPlayerName:function(t,e){t.playerName=e},setRoomName:function(t,e){t.roomName=e},setActiveVoteTitle:function(t,e){t.activeVoteTitle=e},setWSSessionId:function(t,e){t.wsSessionId=e}},actions:{getAllPlayers:function(t){var e=t.commit,o=t.state;g["c"].get("/".concat(o.sessionId,"/users")).then((function(t){var o=t.data;e("setPlayersList",o.session_users)}))},getAllVotes:function(t){var e=t.commit,o=t.state;g["c"].get("".concat(o.sessionId,"/current_votes")).then((function(t){var o=t.data;e("setVotes",o)}))},endVote:function(t){var e=t.commit,o=t.state;return new Promise((function(t,s){g["c"].post("".concat(o.sessionId,"/end_vote")).then((function(o){var s=o.data;console.log("end vote",s),e("setVoteActive",!1),e("setVoteCompleted",!0),t(s.statistics)})).catch((function(){return s("Cannot end the game")}))}))},sendVote:function(t,e){var o=t.commit,s=t.state,n=t.dispatch;g["c"].post("".concat(s.sessionId,"/vote"),{user_name:s.playerName,vote_value:e}).then((function(t){console.log("send vote resp",t),n("getAllVotes"),o("setVoteSet")}))},startNewVote:function(t,e){var o=t.commit,s=t.state;g["c"].post("".concat(s.sessionId,"/new_vote"),{title:e}).then((function(t){console.log("send start new vote resp",t),o("clearVoteStats",!0),o("setVoteActive",!0),o("setVoteCompleted",!1)})).catch((function(){o("setVoteActive",!1),o("setVoteCompleted",!1)}))},getSessionInfo:function(t){var e=t.commit,o=t.state,s=t.dispatch;g["c"].get("".concat(o.sessionId,"/info")).then((function(t){var o=t.data;console.log("session info",o),e("setRoomName",o.session_name),e("setSessionId",o.session_id),e("setPlayersList",o.session_users),e("setInitialCompletedVotes",o.completed_votes),o.active_sessions.length&&(e("setVoteActive",!0),e("setActiveVoteTitle",o.active_sessions[0]),s("getAllVotes"))})).catch((function(t){console.log("session info error",t)}))},activate:function(t){var e=t.commit;y.on("got_new_vote",(function(t){console.log("got new vote",t),e("setVotes",t)})),y.on("new_user_joined",(function(t){console.log("new_user_joined",t),e("addNewUser",t)})),y.on("user_left",(function(t){console.log("user_left",t),e("removeUser",t)})),y.on("new_vote_started",(function(t){e("setActiveVoteTitle",t),e("clearVoteStats",!0),e("setVoteActive",!0),e("setVoteCompleted",!1),v.$emit("newVoteStarted")})),y.on("vote_completed",(function(t){e("setVoteActive",!1),e("setVoteCompleted",!0),e("setVoteStats",t),v.$emit("voteStatsAvailable",t),v.$emit("voteCompleted")}))},resolveAfter2Seconds:function(){return new Promise((function(t){setTimeout((function(){t("resolved")}),2e3)}))}},getters:{getCompletedVotes:function(t){return t.completedVotes}},modules:{}});o("f9e3"),o("2dd8");s["default"].config.productionTip=!1,s["default"].use(n["a"]),s["default"].use(a["a"]),new s["default"]({store:$t,render:function(t){return t(xt)}}).$mount("#app")},d13e:function(t,e,o){},d2d6:function(t,e,o){"use strict";o("f73b")},e21e:function(t,e,o){"use strict";o("af41")},ef66:function(t,e,o){"use strict";o("d13e")},f73b:function(t,e,o){}});
//# sourceMappingURL=game.027a245f.js.map